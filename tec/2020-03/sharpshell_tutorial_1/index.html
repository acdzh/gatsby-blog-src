<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link href="https://cdn.bootcdn.net/ajax/libs/firacode/5.2.0/fira_code.min.css" rel="stylesheet"/><link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.2/css/all.min.css" rel="stylesheet"/><style data-href="/styles.6fd271361286800aedde.css" id="gatsby-global-css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline}code,kbd,samp{font-family:monospace,monospace;font-size:1em}img{border-style:none}button,input{overflow:visible}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}[hidden]{display:none}


/*! modern-normalize v1.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{box-sizing:border-box;border:0 solid #e5e7eb}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#9ca3af}input::placeholder,textarea::placeholder{color:#9ca3af}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block}img,video{max-width:100%;height:auto}*{outline:none}:active,:focus,[role=button]::-moz-focus-inner,button::-moz-focus-inner,input::-moz-focus-inner{outline:none}button.active.focus,button.active:focus,button.focus,button:active.focus,button:active:focus,button:focus{outline:none}:root{--Primary:#308080;--TextTitle:#444;--TextPrimary:#666;--TextQuote:#777;--TextOnBg:hsla(0,0%,100%,0.8);--BgHeader:#308080;--BgPrimary:#fff;--BgBody:#eaeaea;--BgSideBar:#f0f0f0;--BgSideBarHover:#ebebeb;--BgTags:#f2f2f2;--BgCode:#f4f4f4;--BgLicense:#fffeee;--LineSeparatorPrimary:#eee;--LineSeparatorSecondary:#ddd;--LineBorder:#d9d9d9;--LineTable:#f1f1f1}:root,[data-theme=dark]:root{--ConstTextSecondary:hsla(0,0%,100%,0.4);--ConstTextThird:#777;--ConstTextTag:#999;--TextThird:#aaa;--TextCode:var(--Primary);--BgSelect:rgba(0,128,128,0.3764705882352941);--BgFooter:#33363b}[data-theme=dark]:root{--Primary:#409090;--TextTitle:#bbb;--TextPrimary:#999;--TextQuote:#888;--TextOnBg:#bbb;--BgHeader:#33363b;--BgPrimary:#33363b;--BgBody:#292929;--BgSideBar:var(--BgPrimary);--BgSideBarHover:#383838;--BgTags:#2e2e2e;--BgCode:#3a3a3a;--BgLicense:#3e4147;--LineSeparatorPrimary:#555;--LineSeparatorSecondary:#444;--LineBorder:#666;--LineTable:#2d3235}::selection{background:var(--BgSelect)}::-moz-selection{background:var(--BgSelect)}::-webkit-selection{background:var(--BgSelect)}*{transition:background-color,border-color;transition-duration:.2s;transition-timing-function:ease}body{background-color:var(--BgBody);color:var(--TextPrimary);font-family:Helvetica Neue,Hiragino Sans GB,Microsoft YaHei,"\9ED1\4F53",Arial,sans-serif}a{transition-duration:.2s;transition-timing-function:ease}*{min-width:0}.hidden{display:none}[data-theme=light] body code[class*=language-],[data-theme=light] body pre[class*=language-]{color:#383a42;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}[data-theme=light] body code[class*=language-]::-moz-selection,[data-theme=light] body code[class*=language-] ::-moz-selection,[data-theme=light] body code[class*=language-]::selection,[data-theme=light] body code[class*=language-] ::selection,[data-theme=light] body pre[class*=language-]::-moz-selection,[data-theme=light] body pre[class*=language-] ::-moz-selection,[data-theme=light] body pre[class*=language-]::selection,[data-theme=light] body pre[class*=language-] ::selection{text-shadow:none;background:#e5e6e7}@media print{[data-theme=light] body code[class*=language-],[data-theme=light] body pre[class*=language-]{text-shadow:none}}[data-theme=light] body pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}[data-theme=light] body :not(pre)>code[class*=language-],[data-theme=light] body pre[class*=language-]{background:#fff;border:1px solid #e7eaf4}[data-theme=light] body :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}[data-theme=light] body .token.cdata,[data-theme=light] body .token.comment,[data-theme=light] body .token.doctype,[data-theme=light] body .token.prolog{color:#a0a1a7}[data-theme=light] body .token.punctuation{color:#383a42}[data-theme=light] body .token.selector,[data-theme=light] body .token.tag{color:#f07c85}[data-theme=light] body .token.attr-name,[data-theme=light] body .token.boolean,[data-theme=light] body .token.constant,[data-theme=light] body .token.deleted,[data-theme=light] body .token.number,[data-theme=light] body .token.property,[data-theme=light] body .token.symbol{color:#e1aa76}[data-theme=light] body .token.attr-value,[data-theme=light] body .token.builtin,[data-theme=light] body .token.char,[data-theme=light] body .token.inserted,[data-theme=light] body .token.string{color:#88b369}[data-theme=light] body .language-css .token.string,[data-theme=light] body .style .token.string,[data-theme=light] body .token.entity,[data-theme=light] body .token.operator,[data-theme=light] body .token.url{color:#46a6b2}[data-theme=light] body .token.function{color:#519fdf}[data-theme=light] body .token.atrule,[data-theme=light] body .token.important,[data-theme=light] body .token.keyword,[data-theme=light] body .token.regex,[data-theme=light] body .token.variable{color:#b668cd}[data-theme=light] body .token.bold,[data-theme=light] body .token.important{font-weight:700}[data-theme=light] body .token.italic{font-style:italic}[data-theme=light] body .token.entity{cursor:help}[data-theme=light] body pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}[data-theme=light] body pre.line-numbers>code{position:relative}[data-theme=light] body .line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:0;-webkit-user-select:none;-ms-user-select:none;user-select:none}[data-theme=light] body .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}[data-theme=light] body .line-numbers-rows>span:before{content:counter(linenumber);color:#b5b9c2;display:block;padding-right:.8em;text-align:right}[data-theme=light] body code.language-css,[data-theme=light] body code.language-javascript,[data-theme=light] body code.language-js,[data-theme=light] body code.language-jsx,[data-theme=light] body code.language-sass,[data-theme=light] body code.language-scss,[data-theme=light] body code.language-ts,[data-theme=light] body code.language-tsx,[data-theme=light] body code.language-typescript,[data-theme=light] body pre.languagecss,[data-theme=light] body pre.languagejavascript,[data-theme=light] body pre.languagejs,[data-theme=light] body pre.languagejsx,[data-theme=light] body pre.languagesass,[data-theme=light] body pre.languagescss,[data-theme=light] body pre.languagets,[data-theme=light] body pre.languagetsx,[data-theme=light] body pre.languagetypescript{color:#ca1243}[data-theme=dark] body code[class*=language-],[data-theme=dark] body pre[class*=language-]{color:#abb2bf;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}[data-theme=dark] body code[class*=language-]::-moz-selection,[data-theme=dark] body code[class*=language-] ::-moz-selection,[data-theme=dark] body code[class*=language-]::selection,[data-theme=dark] body code[class*=language-] ::selection,[data-theme=dark] body pre[class*=language-]::-moz-selection,[data-theme=dark] body pre[class*=language-] ::-moz-selection,[data-theme=dark] body pre[class*=language-]::selection,[data-theme=dark] body pre[class*=language-] ::selection{text-shadow:none;background:#9aa2b1}@media print{[data-theme=dark] body code[class*=language-],[data-theme=dark] body pre[class*=language-]{text-shadow:none}}[data-theme=dark] body pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}[data-theme=dark] body :not(pre)>code[class*=language-],[data-theme=dark] body pre[class*=language-]{background:#282c34;border:1px solid transparent}[data-theme=dark] body :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}[data-theme=dark] body .token.cdata,[data-theme=dark] body .token.comment,[data-theme=dark] body .token.doctype,[data-theme=dark] body .token.prolog{color:#5c6370}[data-theme=dark] body .token.punctuation{color:#abb2bf}[data-theme=dark] body .token.selector,[data-theme=dark] body .token.tag{color:#e06c75}[data-theme=dark] body .token.attr-name,[data-theme=dark] body .token.boolean,[data-theme=dark] body .token.constant,[data-theme=dark] body .token.deleted,[data-theme=dark] body .token.number,[data-theme=dark] body .token.property,[data-theme=dark] body .token.symbol{color:#d19a66}[data-theme=dark] body .token.attr-value,[data-theme=dark] body .token.builtin,[data-theme=dark] body .token.char,[data-theme=dark] body .token.inserted,[data-theme=dark] body .token.string{color:#98c379}[data-theme=dark] body .language-css .token.string,[data-theme=dark] body .style .token.string,[data-theme=dark] body .token.entity,[data-theme=dark] body .token.operator,[data-theme=dark] body .token.url{color:#56b6c2}[data-theme=dark] body .token.function{color:#61afef}[data-theme=dark] body .token.atrule,[data-theme=dark] body .token.important,[data-theme=dark] body .token.keyword,[data-theme=dark] body .token.regex,[data-theme=dark] body .token.variable{color:#c678dd}[data-theme=dark] body .token.bold,[data-theme=dark] body .token.important{font-weight:700}[data-theme=dark] body .token.italic{font-style:italic}[data-theme=dark] body .token.entity{cursor:help}[data-theme=dark] body pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}[data-theme=dark] body pre.line-numbers>code{position:relative}[data-theme=dark] body .line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:0;-webkit-user-select:none;-ms-user-select:none;user-select:none}[data-theme=dark] body .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}[data-theme=dark] body .line-numbers-rows>span:before{content:counter(linenumber);color:#5c6370;display:block;padding-right:.8em;text-align:right}[data-theme=dark] body code.language-css,[data-theme=dark] body code.language-javascript,[data-theme=dark] body code.language-js,[data-theme=dark] body code.language-jsx,[data-theme=dark] body code.language-sass,[data-theme=dark] body code.language-scss,[data-theme=dark] body code.language-ts,[data-theme=dark] body code.language-tsx,[data-theme=dark] body code.language-typescript,[data-theme=dark] body pre.languagecss,[data-theme=dark] body pre.languagejavascript,[data-theme=dark] body pre.languagejs,[data-theme=dark] body pre.languagejsx,[data-theme=dark] body pre.languagesass,[data-theme=dark] body pre.languagescss,[data-theme=dark] body pre.languagets,[data-theme=dark] body pre.languagetsx,[data-theme=dark] body pre.languagetypescript{color:#fa4273}.responsive-iframe-container{margin:1em auto;overflow:hidden;padding-top:56.25%;position:relative}.responsive-iframe-container>iframe{border:0;height:100%;left:0;position:absolute;top:0;width:100%}.button{min-width:64px;font-size:14px;font-weight:500;line-height:1.75;border-radius:4px;letter-spacing:.02857em;transition-duration:.2s;transition-timing-function:ease}.button:hover{transform:scale(1.02)}.button:hover .button__container{background-color:rgba(0,0,0,.1)}.button--primary{box-shadow:0 1px 5px rgba(0,0,0,.075),0 1px 5px rgba(0,0,0,.1);background-color:var(--Primary);color:var(--TextOnBg)}.button--outline{border:1px solid var(--LineBorder);color:var(--TextPrimary)}.button--outline:hover{color:var(--Primary)}.button__container{padding:5px 15px}.input{background-color:var(--BgPrimry);font-size:14px;padding:0 10px;height:36px;border-radius:4px;border:1px solid var(--LineBorder)}.nav{position:fixed;top:0;left:0;right:0;width:100%;height:50px;z-index:1000;border-radius:0 0 6px 6px;box-shadow:0 1px 5px rgba(0,0,0,.075),0 1px 5px rgba(0,0,0,.1);background-color:var(--BgHeader)}.nav-inner{width:100%;height:100%;max-width:1380px;position:relative;margin:0 auto}.nav-menu{display:flex;flex-direction:row}.nav-menu-left{float:left}.nav-menu-right{float:right}.nav-menu-item{line-height:20px;font-weight:600;border-radius:6px}.nav-menu-item-obj{padding:15px 20px;color:var(--TextOnBg)}.nav-menu-item-button{font-size:20px;width:50px;height:50px;color:var(--TextOnBg)}.nav-menu-item-button:hover,.nav-menu-item-obj:hover{background-color:rgba(0,0,0,.1);color:#fff}.nav-menu-item-text{padding:15px 20px;color:var(--ConstTextSecondary)}.nav-menu-item-bar{display:none}@media only screen and (max-width:900px){.nav-menu-item-bar{display:block}.nav-menu-item-obj,.nav-menu-item-text{display:none}}.nav-expand-menu{position:fixed;top:40px;left:0;right:0;width:100%;z-index:900;padding:10px 20px;border-radius:6px;box-shadow:0 2px 3px rgba(26,26,26,.46);background-color:var(--BgHeader)}@media only screen and (min-width:900px){.nav-expand-menu{display:none}}.nav-expand-menu-item{padding:10px 0}.nav-expand-menu-item-obj{color:var(--TextOnBg)}.nav-expand-menu-item-text{color:var(--ConstTextSecondary)}:target{padding-top:80px;margin-top:-80px}.card-container{border-radius:8px;overflow:hidden;box-shadow:0 1px 5px rgba(0,0,0,.075),0 1px 5px rgba(0,0,0,.1)}.card-container-top{position:relative;height:60px;padding:18px 30px;font-size:16px;font-weight:600;text-transform:uppercase;line-height:24px;border-radius:8px 8px 0 0;white-space:nowrap;overflow:hidden;border-bottom:1px solid var(--LineSeparatorPrimary)}.folded .card-container-top{border-radius:8px}.card-container-top__const li{display:inline-block;margin-right:14px}.card-container-top__const li:hover{color:var(--Primary)}.card-container-top__const{color:var(--TextThird)}.card-container-top__primary{background-color:var(--BgHeader);color:var(--TextOnBg)}.card-container-top-fold-button{display:inline-flex;position:absolute;top:0;bottom:0;height:24px;margin:auto;right:20px;align-items:center;justify-content:center}.folded .card-content{display:none}.card-content a:hover{color:var(--Primary)}.sidebar-content-separator{width:100%;height:1px;background-color:var(--LineSeparatorSecondary)}.sidebar-content-separator:last-child{display:none}.sidebar-content-post-toc{max-height:460px;overflow-y:auto;margin:0;padding:20px 30px;font-size:14px;line-height:2em}.sidebar-content-post-toc li,.sidebar-content-post-toc ul{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.sidebar-content-post-toc ul ul{margin-left:10px}.sidebar-content-post-toc ul ul ul{margin-left:20px}.sidebar-content-post-toc ul ul ul ul{margin-left:30px}.sidebar-content-post-toc a:hover{color:var(--Primary)}.sidebar-content-post-nav-item{width:100%;min-height:106px;position:relative;display:flex;text-align:center;align-items:center;justify-content:center;padding:16px 40px 24px;transition-duration:.3s;transition-timing-function:ease-out}.sidebar-content-post-nav-item:hover{background-color:var(--BgSideBarHover)}.sidebar-content-post-nav-item *{transition-duration:.3s;transition-timing-function:ease-out}.sidebar-content-post-nav-item i{color:var(--TextThird);font-size:16px;position:absolute;margin:auto}.sidebar-content-post-nav-prev i{left:20px}.sidebar-content-post-nav-next i{right:20px}.sidebar-content-post-nav-item:hover i{color:var(--Primary);transform:scale(1.2)}.sidebar-content-post-nav-item strong{display:block;font-size:12px;color:var(--TextThird);letter-spacing:.5px;font-weight:400;text-transform:uppercase}.sidebar-content-post-nav-item span{font-size:14px;color:var(--TextPrimary)}.sidebar-content-post-nav-item:hover span{color:var(--Primary)}.post{margin-bottom:40px;overflow:hidden}.post a{color:var(--Primary)}.post-container{padding:20px 30px}@media only screen and (max-width:812px){.post-container{padding:20px 10px}}.post-title{font-size:38px;letter-spacing:-1px;line-height:1.3em;color:var(--TextTitle);margin-bottom:10px;font-weight:400}@media only screen and (max-width:812px){.post-title{font-size:22px}}.post-meta{font-size:14px;font-weight:400;color:var(--TextThird);text-transform:uppercase;margin-bottom:1em}.post-entry-license{border:1px dashed var(--LineSeparatorPrimary);padding:10px;background-color:var(--BgLicense);background-repeat:no-repeat;background-attachment:scroll;background-position:1% 50%;border-radius:6px}.post-entry{font-size:16px;line-height:1.8em}.post-entry dd,.post-entry hr,.post-entry p{margin-bottom:1em}.post-entry dt{color:var(--TextTitle)}.post-entry ol,.post-entry ul{margin:0 0 15px 30px}.post-entry ol ol,.post-entry ol ul,.post-entry ul ol,.post-entry ul ul{margin-bottom:0}.post-entry li{margin-top:.1em}.post-entry ol ul li,.post-entry ul li{list-style:square}.post-entry ol li,.post-entry ol ul ol li{list-style:decimal}.post-entry dt{font-weight:600}.post-entry address{margin-bottom:1em}.post-entry blockquote{position:relative;color:var(--TextQuote);margin:0 0 20px;padding-left:10px;border-left:3px solid var(--LineBorder)}.post-entry blockquote p{margin-bottom:.75em}.post-entry code,.post-entry pre{font-family:Fira Code,monospace;font-size:14px}@supports(font-variation-settings:normal){.post-entry code,.post-entry pre{font-family:Fira Code VF,monospace}}.post-entry pre{width:100%;margin:10px 0 15px;border:1px solid var(--LineSeparatorSecondary);line-height:19px;white-space:pre;word-wrap:break-word;overflow-x:auto;overflow-y:hidden}.post-entry :not(pre)>code{padding:2px 4px;font-size:90%;color:var(--TextCode);background-color:var(--BgCode);border-radius:4px}.post-entry .line-numbers .line-numbers-rows{padding-top:1em;padding-bottom:1em;font-size:14px;line-height:1.5;padding-left:10px}.post-entry sub,.post-entry sup{font-size:62.5%}.post-entry sub{vertical-align:sub}.post-entry sup{vertical-align:super}.post-entry table{font-size:14px;margin-bottom:1.5em;width:100%;text-align:center}.post-entry table tbody tr:nth-child(odd){background:var(--LineTable)}.post-entry table td{padding:5px;vertical-align:middle}.post-entry table td,.post-entry table th{border-bottom:1px solid var(--LineTable);text-align:center}.post-entry table th{font-weight:600;border-top:1px solid var(--LineTable);padding:10px 5px}.post-entry h1,.post-entry h2,.post-entry h3,.post-entry h4,.post-entry h5,.post-entry h6{color:var(--TextTitle);font-weight:600;-ms-word-wrap:break-word;word-wrap:break-word}.post-entry h1 span,.post-entry h2 span,.post-entry h3 span,.post-entry h4 span,.post-entry h5 span,.post-entry h6 span{color:var(--TextPrimary)}.post-entry h1,.post-entry h2,.post-entry h3,.post-entry h4,.post-entry h5,.post-entry h6{margin-bottom:14px;font-weight:400;line-height:1.8em}.post-entry h1{font-size:38px;letter-spacing:-1px}.post-entry h2{font-size:34px;letter-spacing:-.7px}.post-entry h3{font-size:28px;letter-spacing:-.5px}.post-entry h4{font-size:24px;letter-spacing:-.3px}.post-entry h5{font-size:20px;font-weight:600}.post-entry h6{font-size:18px;font-weight:600;text-transform:uppercase}.post-entry img{text-align:center}@media only screen and (max-width:812px){.post-entry h1{font-size:30px;letter-spacing:-.7px}.post-entry h2{font-size:26px;letter-spacing:-.5px}.post-entry h3{font-size:24px;letter-spacing:-.3px}.post-entry h4{font-size:22px;letter-spacing:-.3px}.post-entry h5{font-size:18px;font-weight:600}.post-entry h6{font-size:16px;font-weight:600;text-transform:uppercase}}.post-entry strong{font-weight:600}.post-entry :not(pre)>code,.post-entry iframe,.post-entry img,.post-entry pre,.post-entry svg,.post-entry table{border-radius:6px;box-shadow:0 1px 5px rgba(0,0,0,.075);border:1px solid var(--LineSeparatorSecondary);overflow:hidden}.post-entry .math svg{border-radius:unset;box-shadow:unset;border:unset}.post-entry .gatsby-resp-image-background-image{border-radius:6px}.post-entry :not(.gatsby-resp-image-background-image)>img{position:relative;display:block;margin-left:auto;margin-right:auto;max-width:650px}.post-entry :not(pre)>code{margin:0 .1em;font-size:14px}.post-tags{margin-top:20px}.post-tags a{background:var(--BgTags);display:inline-block;line-height:16px;white-space:nowrap;font-size:12px;color:var(--ConstTextTag);padding:3px 7px;margin:0 5px 2px 0;border-radius:2px}.post-tags a:hover{color:var(--Primary);transform:scale(1.02);box-shadow:0 1px 5px rgba(0,0,0,.075)}.content-main-container{width:100%;flex:1 1;padding:0 20px 60px;margin-top:80px}@media only screen and (max-width:719px){.content-main-container{padding:0 10px 60px}}.content-main{width:100%;max-width:1380px;margin:0 auto}@media only screen and (min-width:1280px){.content-main-sidebar{flex-shrink:0;width:320px;margin-left:20px}}@media only screen and (min-width:719px) and (max-width:1280px){.content-main-sidebar{position:fixed;right:20px}}@media only screen and (max-width:719px){.content-main-sidebar{position:fixed;right:10px}}@media only screen and (max-width:1280px){.content-main-sidebar .card-container{width:320px}.content-main-sidebar .card-container.folded{width:64px}.content-main-sidebar .card-container.folded .card-container-top-fold-button{left:20px}.content-main-sidebar .card-container.folded .card-container-top-inner{display:none}}.footer{width:100%;position:relative;background-color:var(--BgFooter);border-radius:8px 8px 0 0;box-shadow:0 1px 5px rgba(0,0,0,.075)}.footer-back-topp{background:hsla(0,0%,100%,.7);color:var(--ConstTextThird);overflow:hidden;text-align:center;width:60px;height:30px;display:flex;margin:0 auto;border-radius:0 0 3px 3px;box-shadow:inset 0 1px 0 rgba(0,0,0,.05);justify-content:center;align-items:center;font-size:38px;font-weight:900}.footer-container{width:100%;max-width:1380px;position:relative;margin:0 auto;padding:0 30px 30px}.footer-container .footer-left-pad{font-size:1.1rem;line-height:1.5rem;color:hsla(0,0%,100%,.4)}.footer-container .footer-left-pad a,.footer-container .footer-right-pad{color:hsla(0,0%,100%,.7)}@media only screen and (min-width:719px){.footer-container{display:grid;grid-template-columns:1fr 1fr}.footer-container .footer-right-pad{text-align:right}}@media only screen and (max-width:719px){.footer-container{display:block}.footer-container .footer-left-pad,.footer-container .footer-right-pad{margin-top:10px;text-align:center}}.footer-sociall-links{font-size:1.5rem}.footer-sociall-links a{padding:0 4px}.featured{padding-bottom:30px;margin-bottom:30px;border-bottom:1px solid var(--LineSeparatorPrimary)}.featured-post-meta{text-transform:none;font-size:14px;font-weight:400;color:var(--TextThird);margin-bottom:.3em}.featured-post-title{margin-bottom:10px;color:var(--TextTitle);font-size:30px;font-weight:400;line-height:1.4em;letter-spacing:-.7px}@media only screen and (max-width:812px){.featured-post-title{font-size:22px}}.featured-post-body{display:flex}.featured-post-cover{margin-right:18px;flex-shrink:0;border-radius:6px;transition-duration:.3s;transition-timing-function:ease}.featured-post-body:hover .featured-post-cover{transform:scale(1.02);box-shadow:0 1px 5px rgba(0,0,0,.15)}@media only screen and (max-width:900px){.featured-post-body{display:block}.featured-post-cover{float:left}}.featured-post-content{font-size:16px;line-height:1.8em;word-break:break-all}.featured-post-content-read-more{color:var(--Primary);font-size:small}.featured-post-tags{margin-top:8px}.featured-post-tags a{background:var(--BgTags);display:inline-block;line-height:16px;white-space:nowrap;font-size:12px;color:var(--ConstTextTag);padding:3px 7px;margin-right:5px;border-radius:2px}.featured-post-tags a:hover{color:var(--Primary);transform:scale(1.02);box-shadow:0 1px 5px rgba(0,0,0,.075)}.simple-featured{border-bottom:1px solid var(--LineSeparatorPrimary);padding:10px 0;font-size:16px;font-weight:400;display:flex;flex-direction:row}.simple-featured-date{margin-right:20px;flex-shrink:0;color:var(--TextThird)}@media only screen and (max-width:812px){.simple-featured{flex-direction:column}.simple-featured-date{margin-right:0;margin-bottom:10px}}.pagination{margin:0;padding:0;list-style:none;font-size:14px}.pagination-item{min-width:32px;text-align:center;list-style:none;border:1px solid;border-radius:6px;outline:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:inline-block;height:32px;margin-right:10px;line-height:30px;vertical-align:middle;transition-duration:.2s;transition-timing-function:ease}.pagination-item-enabled{cursor:pointer;border-color:var(--LineBorder)}.pagination-item-active,.pagination-item-enabled:hover{border-color:var(--Primary);color:var(--Primary);box-shadow:0 1px 5px rgba(0,0,0,.075)}.pagination-item-disabled{cursor:not-allowed;color:var(--TextThird);border-color:var(--TextThird)}.pagination-item a{display:block;padding:0 6px}</style><meta name="generator" content="Gatsby 2.32.3"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=ffb2f5920276563941e386260c477317" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#008080"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=ffb2f5920276563941e386260c477317"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=ffb2f5920276563941e386260c477317"/><title data-react-helmet="true">从零开始的 .Net Shell 扩展教程 (一) - Shell 上下文菜单 | 随便写写</title><link data-react-helmet="true" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.12.0/katex.min.css" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="使用 .Net 快速创建 Shell 上下文菜单扩展."/><meta data-react-helmet="true" property="og:title" content="从零开始的 .Net Shell 扩展教程 (一) - Shell 上下文菜单"/><meta data-react-helmet="true" property="og:description" content="使用 .Net 快速创建 Shell 上下文菜单扩展."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="acdzh"/><meta data-react-helmet="true" name="twitter:title" content="从零开始的 .Net Shell 扩展教程 (一) - Shell 上下文菜单"/><meta data-react-helmet="true" name="twitter:description" content="使用 .Net 快速创建 Shell 上下文菜单扩展."/><link as="script" rel="preload" href="/webpack-runtime-eadd60745f2c20ad7d5b.js"/><link as="script" rel="preload" href="/framework-eb684e3e828ad13b3940.js"/><link as="script" rel="preload" href="/app-0acea366b700cb2006c4.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/8c3ff73a-c498f4d9bc8664bd7de9.js"/><link as="script" rel="preload" href="/commons-952fdd3eb3e92eb702de.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-18a2e622c97be6b86328.js"/><link as="fetch" rel="preload" href="/page-data/tec/2020-03/sharpshell_tutorial_1/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3017845491.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3975179661.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" style="height:100vh;display:flex;flex-direction:column"><div class="nav-expand-menu hidden"><a rel="nofollow" href="/"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-home" aria-hidden="true"></i>  Index</div></a><a rel="nofollow" href="/categories/"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-folder-open" aria-hidden="true"></i>  <!-- -->Categories</div></a><a rel="nofollow" href="/series/"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-bookmark" aria-hidden="true"></i>  <!-- -->Series</div></a><a rel="nofollow" href="/tags"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-tags" aria-hidden="true"></i>  <!-- -->Tags</div></a><a rel="nofollow" href="/about"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-user" aria-hidden="true"></i>  <!-- -->About</div></a><a rel="nofollow" href="/rss.xml"><div class="nav-expand-menu-item nav-expand-menu-item-obj"><i class="fas fa-heart" aria-hidden="true"></i>  <!-- -->RSS</div></a><div class="nav-expand-menu-item nav-expand-menu-item-text">---0-0-0---</div></div><nav class="nav"><div class="nav-inner"><div class="nav-menu nav-menu-left"><button class="nav-menu-item nav-menu-item-button nav-menu-item-bar"><i class="fa fa-bars" aria-hidden="true"></i></button><a rel="nofollow" href="/"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-home" aria-hidden="true"></i>  Index</div></a><a rel="nofollow" href="/categories/"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-folder-open" aria-hidden="true"></i>  <!-- -->Categories</div></a><a rel="nofollow" href="/series/"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-bookmark" aria-hidden="true"></i>  <!-- -->Series</div></a><a rel="nofollow" href="/tags"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-tags" aria-hidden="true"></i>  <!-- -->Tags</div></a><a rel="nofollow" href="/about"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-user" aria-hidden="true"></i>  <!-- -->About</div></a><a rel="nofollow" href="/rss.xml"><div class="nav-menu-item nav-menu-item-obj"><i class="fas fa-heart" aria-hidden="true"></i>  <!-- -->RSS</div></a><div class="nav-menu-item nav-menu-item-text">---0-0-0---</div></div><div class="nav-menu nav-menu-right"><button class="nav-menu-item nav-menu-item-button"><i class="fa" aria-hidden="true"></i></button></div></div></nav><div class="content-main-container"><main class="content-main" style="display:flex;flex-direction:row"><div style="flex:1"><div class="card-container" style="background-color:var(--BgPrimary)"><div class="card-container-top card-container-top__const"><div class="card-container-top-inner"><ul><li><a title="All posts in category 技术" rel="category tag" href="/categories/技术">技术</a></li><li><a title="All posts in category CSharp" rel="category tag" href="/categories/CSharp">CSharp</a></li><li><a title="All posts in category Windows" rel="category tag" href="/categories/Windows">Windows</a></li><li><a title="All posts in series 从零开始的 .Net Shell 扩展教程" rel="series tag" href="/series/从零开始的-.Net-Shell-扩展教程">从零开始的 .Net Shell 扩展教程</a></li></ul></div><div class="card-container-top-fold-button" role="button" tabindex="-1"><i class="fa fa-chevron-up" aria-hidden="true"></i></div></div><div class="card-content"><div class="post-container"><article class="post"><h1 class="post-title">从零开始的 .Net Shell 扩展教程 (一) - Shell 上下文菜单</h1><p class="post-meta">by <!-- -->acdzh &amp; dave kerr<!-- --> · <!-- -->2020年03月07日 07:20:00<!-- --> · <!-- -->703<!-- --> WORDS  ·  ~ <!-- -->3<!-- --> mins reading time · <span id="" class="leancloud_visitors" data-flag-title="从零开始的 .Net Shell 扩展教程 (一) - Shell 上下文菜单"><span class="leancloud-visitors-count"></span></span>  Visitors | <a href="//github.com/acdzh/gatsby-blog-src/blob/master/blog/tec/2020-03/1 .NET Shell Extensions - Shell Context Menus/index.md" target="_blank" rel="noreferrer">raw on <i class="fab fa-github"></i></a></p><div class="post-entry"><p>使用 .Net 快速创建 Shell 上下文菜单扩展.</p><h2 id="介绍">介绍</h2><p>在 .NET 4.0 之前, 不可能使用 .NET 代码可靠地创建 Windows Shell 扩展. 通过对框架的改进, 现在可以使用 .NET 创建这些扩展. 在本文中, 我将向您展示如何快速将 Shell 上下文菜单创建为 C＃ 类库. </p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:394px">
      <a class="gatsby-resp-image-link" href="/static/ec7f708e2305f3199e1c7cfaa32c613c/cc097/195744.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:36.19631901840491%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABdElEQVQoz2WR6W7bMBCE/f4vVRRo/7RpWiepI1uybomkbMuSKOpy6q9rA71QAgPuLpeD2dnVxfkc1CtZolCl4namYcJ1jv0uYOv5TG5iHubf9y/c8rEf6dse21iMqVgVOietIpImJjqFmNFwbI4sbiEQsqfHJ9IwJfKlJ5CeXUS6T+61G4q0ZHYzrnEUWc7K9g5daeJc1IQemUrobMtox/uHWEgO6oDKFaYw6FzLrdESV1Kvq5qpn+iF0KiSVW5aHjYF7x8i3n0K+LAuSY3jImOn+/hOcF2uXMZFVM8sw1+QfBay0Q4MMvZmX7Aqq5bnQPH5OebjV5/HrSYzlubcE4cFSaQ4HS31qae3C7ab/8Ot3jUTXigKBzdwMIo8jggDn2NlODcdvi8+ZTWel/N9k+AHmrp5k7c3mvbHP2i7K6f6gtZaPLSOUrYbRzHb7U5iWUp9EHXfyMOM7YsnyxF/X15Zf1lTJMXdL9f+wdAN2LNsWZf8BOXyCyCp7dpGAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="https://www.codeproject.com/KB/shell/512956/Screenshot8_SampleMenu.png" title="https://www.codeproject.com/KB/shell/512956/Screenshot8_SampleMenu.png" src="/static/ec7f708e2305f3199e1c7cfaa32c613c/cc097/195744.png" srcSet="/static/ec7f708e2305f3199e1c7cfaa32c613c/222b7/195744.png 163w,/static/ec7f708e2305f3199e1c7cfaa32c613c/ff46a/195744.png 325w,/static/ec7f708e2305f3199e1c7cfaa32c613c/cc097/195744.png 394w" sizes="(max-width: 394px) 100vw, 394px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><p><strong><em>上图是本文的一个例子, 这是一个Shell上下文菜单扩展- &quot;Count Lines...&quot;. 本文将使用这个例子来演示如何创建的自定义Shell扩展.</em></strong></p><h2 id="系列文章">系列文章</h2><p>本文是 &quot;.NET Shell扩展&quot; 系列的一部分，其中包括：</p><ol><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_1">.NET Shell扩展-Shell 上下文菜单</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_2">.NET Shell扩展-Shell 图标处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_3">.NET Shell扩展-Shell 信息提示处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_4">.NET Shell扩展-Shell 拖拽处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_5">.NET Shell扩展-Shell 预览处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_6">.NET Shell扩展-Shell 图标叠加处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_7">.NET Shell扩展-Shell 缩略图处理程序</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_8">.NET Shell扩展-Shell 属性表</a></li><li><a href="https://blog.acdzh.ltd/tec/2020-03/sharpshell_tutorial_9">.NET Shell扩展-部署 SharpShell 服务</a></li></ol><h2 id="什么是-shell-上下文菜单">什么是 Shell 上下文菜单?</h2><p>Shell 上下文菜单是在系统中中注册的 COM servers, 它允许对 Shell 对象的上下文菜单进行扩展. 扩展的对象可以是特定的文件类型 (例如 *.txt 文件), 也可以是驱动器或者文件夹. 上下文菜单可以提供一些可以用 Windows 资源管理器进行快速访问的高级功能.</p><h2 id="入门">入门</h2><p>开发 Shell 扩展需要设计很多工作. 必须实现特定的 COM 接口, 必须构建服务器, 必须使用多种方式更新注册表. 我们将使用我开发的一个名为 <code class="language-text">SharpShell</code> 的库来完成所有这些艰苦的工作, 我们所需要做的仅仅是创建一个轻量级类库, 它包含我们要实现的扩展类.</p><h2 id="我们的目标">我们的目标</h2><p>下面的代码创建了一个 Shell 扩展, 您可以通过右键单击任意文本文件并选择 &quot;计数行&quot; 来对统计其行数. 在本文的剩余部分, 我将向您展示如何创建这样的库. 之所以先展示这些代码, 是因为我想强调编写这些库到底有多么简单, 如果使用 <code class="language-text">SharpShell</code> 的话.</p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// The CountLinesExtensions is an example shell context menu extension,</span>
<span class="token comment">/// implemented with SharpShell. It adds the command &#x27;Count Lines&#x27; to text</span>
<span class="token comment">/// files.</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token punctuation">[</span><span class="token function">ComVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">COMServerAssociation</span><span class="token attribute-arguments"><span class="token punctuation">(</span>AssociationType<span class="token punctuation">.</span>ClassOfExtension<span class="token punctuation">,</span> <span class="token string">&quot;.txt&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountLinesExtension</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SharpContextMenu</span></span> <span class="token punctuation">{</span>
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// Determines whether this instance can a shell</span>
    <span class="token comment">/// context show menu, given the specified selected file list</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token comment">/// &lt;returns&gt;</span>
    <span class="token comment">/// &lt;c&gt;true&lt;/c&gt; if this instance should show a shell context</span>
    <span class="token comment">/// menu for the specified file list; otherwise, &lt;c&gt;false&lt;/c&gt;</span>
    <span class="token comment">/// &lt;/returns&gt;</span>
    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">CanShowMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  We always show the menu</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// Creates the context menu. This can be a single menu item or a tree of them.</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token comment">/// &lt;returns&gt;</span>
    <span class="token comment">/// The context menu for the shell context menu.</span>
    <span class="token comment">/// &lt;/returns&gt;</span>
    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">ContextMenuStrip</span> <span class="token function">CreateMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  Create the menu strip</span>
        <span class="token class-name"><span class="token keyword">var</span></span> menu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ContextMenuStrip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//  Create a &#x27;count lines&#x27; item</span>
        <span class="token class-name"><span class="token keyword">var</span></span> itemCountLines <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ToolStripMenuItem</span> <span class="token punctuation">{</span>
            Text <span class="token operator">=</span> <span class="token string">&quot;Count Lines...&quot;</span><span class="token punctuation">,</span>
            Image <span class="token operator">=</span> Properties<span class="token punctuation">.</span>Resources<span class="token punctuation">.</span>CountLines
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
        <span class="token comment">//  When we click, we&#x27;ll count the lines</span>
        itemCountLines<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">CountLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//  Add the item to the context menu.</span>
        menu<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>itemCountLines<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//  Return the menu</span>
        <span class="token keyword">return</span> menu<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// Counts the lines in the selected files</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CountLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  Builder for the output</span>
        <span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//  Go through each file.</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> filePath <span class="token keyword">in</span> SelectedItemPaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//  Count the lines</span>
            builder<span class="token punctuation">.</span><span class="token function">AppendLine</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;{0} - {1} Lines&quot;</span><span class="token punctuation">,</span> 
              Path<span class="token punctuation">.</span><span class="token function">GetFileName</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">,</span> File<span class="token punctuation">.</span><span class="token function">ReadAllLines</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 
        <span class="token comment">//  Show the output</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>代码非常干净, 实现起来也很简单. 现在让我们详细了解如何使用 <code class="language-text">SharpShell</code> 来创建此 Shell 的上下文菜单.</p><h2 id="第一步-建立项目">第一步: 建立项目</h2><p>首先, 创建一个新的 C# 类库 (C# Class Library) 项目.</p><blockquote><p><strong>提示</strong>: 您可以使用 Visual Basic 而不是 C#. 虽然本文中的源代码是 C#, 但是创建 Visual Basic Shell 扩展的方法是相同的.</p></blockquote><p>在这个例子中, 我们将项目叫做 &#x27;<code class="language-text">CountLinesExtension</code>&#x27;.</p><p>现在添加下列引用:</p><ol><li><code class="language-text">System.WIndows.Forms</code></li><li><code class="language-text">System.Drawing</code></li></ol><p><code class="language-text">System.Windows.Forms</code> 是必需的, 因为我们将使用 Winforms <code class="language-text">ContextMenuStrip</code> 来定义上下文菜单. 因为我们要使用图标, 因此 <code class="language-text">System.Draeing</code> 也是必需的.</p><p>将 &#x27;Class1.cs&#x27; 文件重命名为 &#x27;CountLinesExtension.cs&#x27;. 现在, 我们的项目结构应该像下图一样:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:324px">
      <a class="gatsby-resp-image-link" href="/static/6318bfec87cdf67848e05bf66ebad831/67580/200451.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:65.03067484662577%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC5UlEQVQ4y32S62/TVhjG/W0XlQ7YWgqlVWluTmwncWzHufgSJ056SdJGgCbUL/s09SIYvYiFadU2USE0tH7Y/4BaqmlLNzZNQtvExh/249jAhIS2Dz8973vs9znn6DyStvcI+e6IwpcjzK9OqX5zinPvF+yvT/lg6zHj/3LyRv2SM5uPOX/zhEu3T7j8+ROmbxwgmcNHFPdHGPs/Ye3/SF0YevdOhY44u3XM2MYxZzaOGFs/EgZRfxQz/qoe3zxi6tYxs8MnzK4JQ00roqkFIg2CkKDVph0GzM0l2Vpfx3dc6pUqpl6i5bm44Qq1Zo+m67La62ObFqv9FfJqHk3RkOp1H88LBA1h2H5p2uzQELrcXcFvtKhUXcp2HdOqYJYdDEHJsOM1Q2il4hCGi1jlGlLYXmR1dUDYbNMQwwudJcEiHbEeaUsYO3WPivi5WDAo5EuUdJNSqUyxaMaUrSqDwXVct4mkKxad5oD+1Wtilw69lYHYsYZlO1TrLnbVwRWnr7s+Db9Bw3UwxTXDZouPr1+juyROZhgYJR01pyBNfDZievsHahtfoB78Se3hM6z7f1D59hnB4d94h89xDv/B+e45E8OnvL/7O+/e/pX3tn9j/M5TxvZEf+tn3rnzFx+tPUSa6m0zd3UHORzQ3Pked+M+tU8PcDcfEN58QGHtLnmBdmPIZH+Xc8u7fNjb43w3qnc41436Xc72h1xufYKUmb1IIT1PUVFo1Ww826QX+thFlXJBYX56kisXJ7hyaZL0zAXkmSnk2bfJzEySS8whJdNZtLxOoahT8zz8oEXYXiCVyZLJKuREHBRBNqfGfSqTI5mW3yKRksV3FSmVSqOqGoqmolp5dN0QERJRcoW5eISgEYgoNePaFZnUxcaJRJJo7k2SyRSynENKC/f5+URs2hLRcRyPpaVlFhYWCXz/Vd8V4dfiodfD/2OYiZtII3Li6SM0LR9rNptDUcR1M3L833+ZvjZ8Ab5AzSS2kOr7AAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="200451" title="200451" src="/static/6318bfec87cdf67848e05bf66ebad831/67580/200451.png" srcSet="/static/6318bfec87cdf67848e05bf66ebad831/222b7/200451.png 163w,/static/6318bfec87cdf67848e05bf66ebad831/67580/200451.png 324w" sizes="(max-width: 324px) 100vw, 324px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><blockquote><p><strong>译者注</strong>: 原文这里似乎确实缺了一张图, 此为译者补图. 另外关于此部分, 建议去看看第二篇文章的注释.</p></blockquote><h2 id="第二步-引用-sharpshell">第二步: 引用 SharpShell</h2><p>现在我们需要添加核心库 <code class="language-text">SharpShell</code> 的引用. 您可以通过几种不同的方式进行此操作.</p><h3 id="添加引用">添加引用</h3><p>下载文章顶部名为 &quot;SharpShell Library&quot; 的 zip 文件, 并对下载的 SharpShell.dll 添加引用.</p><blockquote><p><strong>提示</strong>: 撰写本文时, 本文的下载是正确的. 如果需要最新版本, 请使用 Nuget (如下所述) 或从 <a href="http://sharpshell.codeplex.com/">sharpshell.codeplex.com</a>获取该库.</p></blockquote><h3 id="使用-nuget">使用 Nuget</h3><p>如果已安装 Nuget, 则只需要快速 SharpShell 并直接安装即可. 或者在<a href="https://www.nuget.org/packages/SharpShell">https://www.nuget.org/packages/SharpShell</a>中获取软件包的详细信息.</p><h3 id="使用-codeplex">使用 CodePlex</h3><p>该页面上的库可能不是最新版本, 但是您可以从 CodePlex 获取最新版本 - 在 SharpShell 的主页上: <a href="https://sharpshell.codeplex.com">https://sharpshell.codeplex.com</a>. Nuget 可以下载最新的稳定版本, 而 CodePlex 有可能有 beta 版本, 文章顶部的链接则是在撰写本是时测试通过的版本.</p><blockquote><p><strong>译者注</strong>: 这个项目的 CodePlex 主页已经停用了. 请前往 <a href="https://github.com/dwmkerr/sharpshell">Github 主页</a>查看最新版本.</p></blockquote><h2 id="第三步-从-sharpcontextmenu-继承-deriving-from-sharpcontextmenu">第三步: 从 SharpContextMenu 继承 (Deriving from SharpContextMenu)</h2><p>现在事情变得有趣了. 使你的类 <code class="language-text">CountLinesExtension</code> 继承 <code class="language-text">SharpContextMenu</code>:</p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// The Count Lines Context Menu Extension</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountLinesExtension</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SharpContextMenu</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>现在我们必须实现该类的抽象函数. 右键单击这一行的 <code class="language-text">SharpContextMenu</code>, 然后选择 &quot;<strong>实现抽象类</strong>&quot; (&#x27;<strong>Implement Abstract Class</strong>&#x27;)</p><blockquote><p><strong>译者注</strong>: 原文如此. 但在 VS 2019 中未找到此选项. 也可以通过在 <code class="language-text">CountLinesExtension</code> 上按 <code class="language-text">Alt</code> + <code class="language-text">Enter</code>, 选择 &quot;实现抽象类&quot; 亦可. (当然自己不使用代码生成, 自己手动补全也是可以的</p></blockquote><p>这将创建所需的两个函数的实现 - <code class="language-text">CanShowMenu</code> 和 <code class="language-text">CreateMenu</code>: </p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// The Count Lines Context Menu Extension</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountLinesExtension</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SharpContextMenu</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">CanShowMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NotImplementedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">ContextMenuStrip</span> <span class="token function">CreateMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NotImplementedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>通过实现这两个方法, 我们可以提供所需的所有功能. 它们的作用如下:</p><h3 id="canshowmenu">CanShowMenu</h3><p>对于给定的文件扩展名集合, 通过调用此函数来确定我们是否显示其上下文菜单. 用户选择的文件在属性 <code class="language-text">SelectedItemPaths</code> 中. 我们可以检查这些文件路径, 来判断我们是否需要显示菜单. 如果需要显示菜单, 返回 <code class="language-text">true</code> , 否则返回 <code class="language-text">false</code>.</p><h3 id="createmenu">CreateMenu</h3><p>这个函数会被调用, 来实际创建上下文菜单. 我们只需要返回一个标准 Winforms <code class="language-text">ContextMenuStrip</code>.</p><p>这是我们对这两个方法的实现:</p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">CanShowMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  We will always show the menu</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">ContextMenuStrip</span> <span class="token function">CreateMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  Create the menu strip</span>
    <span class="token class-name"><span class="token keyword">var</span></span> menu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ContextMenuStrip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">//  Create a &#x27;count lines&#x27; item</span>
    <span class="token class-name"><span class="token keyword">var</span></span> itemCountLines <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ToolStripMenuItem</span> <span class="token punctuation">{</span>
        Text <span class="token operator">=</span> <span class="token string">&quot;Count Lines&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
    <span class="token comment">//  When we click, we&#x27;ll call the &#x27;CountLines&#x27; function</span>
    itemCountLines<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">CountLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">//  Add the item to the context menu</span>
    menu<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>itemCountLines<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">//  Return the menu</span>
    <span class="token keyword">return</span> menu<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CountLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  Builder for the output</span>
    <span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">//  Go through each file</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> filePath <span class="token keyword">in</span> SelectedItemPaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  Count the lines</span>
        builder<span class="token punctuation">.</span><span class="token function">AppendLine</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;{0} - {1} Lines&quot;</span><span class="token punctuation">,</span> 
          Path<span class="token punctuation">.</span><span class="token function">GetFileName</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">,</span> File<span class="token punctuation">.</span><span class="token function">ReadAllLines</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//  Show the output</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> </code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div><p>对于 <code class="language-text">CanShowMenu</code>, 我们总是返回 <code class="language-text">true</code>, 我们不需要验证文件是否是文本文件, 并且很快就会看到这样做的原因. 对于 <code class="language-text">CreateMenu</code>, 我们构造一个仅包含一项的上下文菜单条 (context menu strip), 它拥有标题 &#x27;<strong>Count Lines</strong>&#x27;, 并且调用 <code class="language-text">CountLines</code> 函数.</p><p><code class="language-text">CountLines</code> 函数遍历 <code class="language-text">SelectedItemPaths</code>, 并计算每一个文件的行数, 之后再显示一个带有摘要的消息框 (MessageBox).</p><h2 id="第四步-处理-com-注册">第四步: 处理 COM 注册</h2><p>还有一些事情要做. 首先, 我们必须将 <code class="language-text">COMVisible</code> 属性添加到我们的类中.</p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ComVisible</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountLinesExtension</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SharpContextMenu</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span></span></pre></div><p>为什么这么做? 好吧, 尽管我们的类看起来并不太像, 但它实际上确实是一个 COM 服务器 (COM server). 如果你去查看基类, 你将会看到, 我们在实现 COM 接口, 比如 <code class="language-text">IShellExtInit</code>, <code class="language-text">IContextMenu</code>, <code class="language-text">ISharpShellServer</code>. 我们不必关心它们做什么, 但是为了系统能创建我们的扩展, 它必须要有此属性.</p><p>接下来, 我们必须给这个程序集一个强名称 (strong name). 有很多方式可以实现此需求, 不过我们有一个最好的方法. 为此, 我们需要在项目上单击鼠标右键, 然后点击 &quot;<strong>属性</strong>&quot;, 然后转到 &quot;<strong>签名</strong>&quot;, 选择 &quot;<strong>为程序集签名</strong>&quot;, 单击 &quot;<strong>选择强名称密钥文件</strong>&quot; 下的下拉列表, 选择 &quot;<strong>新建</strong>&quot;. 之后新建一个密钥, 您可以根据需要对密钥进行密码保护, 但这不是必需的.</p><p>最后一步, 我们需要将我们的扩展与一些文件类型关联. 我们可以通过 <code class="language-text">COMServerAssociation</code> 属性 (由 SharpShell 提供) 来做到这一点:</p><div class="gatsby-highlight" data-language="csharp"><pre style="counter-reset:linenumber NaN" class="language-csharp line-numbers"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ComVisible</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">COMServerAssociation</span><span class="token attribute-arguments"><span class="token punctuation">(</span>AssociationType<span class="token punctuation">.</span>ClassOfExtension<span class="token punctuation">,</span> <span class="token string">&quot;.txt&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CountLinesExtension</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SharpContextMenu</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span></span></pre></div><p>那么, 我们在这一步都做了什么? 我们告诉 SharpShell 当注册这个服务时, 我们希望它与 <em>.txt 文件的<strong>类型</strong>进行关联. 这意味着, 我们不仅可以使其对任何文件名以 </em>.txt 结尾的文件有效, 同样对同类的文件同样有效. 从根本上来讲, 多数情况下, 这些文件与 *.txt 具有相同的图标.</p><blockquote><p><strong>译者注</strong>: 这一段直译过来有些拗口, 实际上原作者想表达的意思是, <em>.txt 文件的文件类型(Contene-Type)是 text/plain. 当我们让其与 </em>.txt 进行关联, 实际上是与 <em>.txt 的文件类型 text/plain 进行关联, 因此这个扩展不仅仅对 </em>.txt 有效, 同样对其他 text/plain 文件类型也有效</p></blockquote><p>您可以使用 <code class="language-text">COMServerAssociation</code> 属性来做一些非常酷的事. 您可以将其与文件夹, 驱动器, 未知文件, 以及特定的扩展名相关联. 有关此功能的完整文档, 请访问<a href="http://sharpshell.codeplex.com/">SharpShell CodePlex</a>页面上的<a href="http://sharpshell.codeplex.com/wikipage?title=COM%20Server%20Associations&amp;referringTitle=Documentation">COM 服务关联</a>.</p><blockquote><p><strong>译者注</strong>: 这个页面已经停止服务了. 文档请访问此 <a href="https://github.com/dwmkerr/sharpshell/blob/master/docs/com-server-associations.md">Github链接</a>.</p></blockquote><p>就这样, Build 该项目将创建 <code class="language-text">CountLinesExtension</code> 程序集. 这个程序集可以作为一个 COM server 进行注册, 添加到系统的上下文菜单中. 为了注册这个 COM 服务器, 我们需要对其进行调试和部署. 我们将在下一节讨论细节.</p><h2 id="调试-shell-扩展">调试 Shell 扩展</h2><p>Shell 扩展程序会被托管在 Windows 资源管理器中. 因为 .Net COM 服务迂回的加载方式, 让调试器进入进程托管代码并逐步执行进行调试几乎是不可能的. 但是, 有一种方法可以快速调试扩展. <code class="language-text">SharpShell</code>附带了一些工具, 能让 <code class="language-text">SharpShell</code> COM 服务加载更简单一些, 其中之一就是 Server Manager. (SharpShell comes with some tools that make working with SharpShell COM servers a bit easier, and one of them is the Server Manager.) 我们可以使用此工具来 debug 我们的扩展.</p><p>打开 Server Manager, 然后使用 &#x27;<strong>File</strong>&#x27; &gt; &#x27;<strong>Load Server</strong>&#x27; 来加载构建好的的 server 文件（DLL）. 您同样可以直接将 server 文件拖拽进主窗口. 选中这个 server , 右侧将会显示它的一些细节信息.</p><p>Server Manager 非常有用, 他可以告诉您, 这个 server 是否已经安装 (32 或者 64位模式), 以及其他的一些细节.</p><p>如果您加载了 <code class="language-text">SharpContextMenu</code> server 并选中, 您可以打开 &#x27;<strong>Tools</strong>&#x27; 菜单, 选择 &#x27;<strong>Test Context Menu</strong>&#x27;.</p><p>当您使用 &#x27;<strong>Test Context Menu</strong>&#x27; 后, 您将获得一个 Test Shell 窗口. 这是一个 Windows 资源管理器的基本实现. 您可以在任意文件上右键来测试这个 Shell 上下文菜单.</p><p><strong>提示</strong>: 无论您设置了<strong>哪种 COMServerAssocations</strong>, Test Shell 都会尝试为所有项目创建上下文菜单.</p><p>将调试器附加到 <em>ServerManager.exe</em> 进程可以允许您调试您的上下文菜单并且进行测试, 而不必真正在 Windows 中注册. 这是当运行 Count Line 上下文菜单扩展时, TestShell 的样子:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:650px">
      <a class="gatsby-resp-image-link" href="/static/63c9260802901d0bf221e58af5cd204e/321ea/200549.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:69.93865030674846%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACX0lEQVQ4y4VT207bQBD1/z8UqRf4gaqqRIG+QqX2oSWkhAoKsZMAIbZDHF92fVl7YydOcjq7IShqIzrSaGbt8fE5MzvGq4/fsPP+C3Y+fMXr/VO82W9QbOj87adV3D1o4B357sGZjjo/amLv6Cf2Pp9j97BJfqaj0R5yXPX6SJmH6XSGOI6R5xnKUiLJckyrEv1AIBIlWJIhkxWKcgqepLqWswhhGMD3x4g5h+HHAsetNiyrA2Ujb4yIhagIKE4VwBRHpsCJxXFy7eHY5GjZGToPI1ybPTCeUH2MIGTaDZ4KXJhtsCjUgN54DCkLzOc1ZFlhVs+Rywmd52heXUJOJBaLBVicwnZHBJhi7AfISE1RTGDkhcSldYPzVgt1XZPcgqQwlPQhixMCmCBLU2JcwRk+YF5XBLhElkuqSyBEjgnVrM3IRIrbzinOf13C6nQRRhGWyyW5er1c5SpbPdCm2MakzCdmnEAHjksMM11nFEUK3zlFp3ePu/s+/CB4/ngTZPM8J8kKMElWzD3P04BlWcIoyxyBe6Z7oiylF6pHa4C/fc1Q3YAgCBEnCVIaXk29fmboDb6jbXXpjwkY47pHLzGsCXBCA1M9X9eu3xsVMeSjppYspdRNVgxeBCQ2Suo2FYbIYoztBrq3fZpg/Q/gNsmK2WxWY5s9Sf6B/sDVDzIhNOA2sM0ectoStSlKlRrG2g0hEjzaF7h/cOhiFhrwf6aGpibrOA4iWgi9grR2evV+X9/ANC3c3fVh0vp1ez047hDu8BED26bcfToPYdN9YzzWU1XD45RHFCPGdAwjhj8g5h878yIOFwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="200549" title="200549" src="/static/63c9260802901d0bf221e58af5cd204e/a6d36/200549.png" srcSet="/static/63c9260802901d0bf221e58af5cd204e/222b7/200549.png 163w,/static/63c9260802901d0bf221e58af5cd204e/ff46a/200549.png 325w,/static/63c9260802901d0bf221e58af5cd204e/a6d36/200549.png 650w,/static/63c9260802901d0bf221e58af5cd204e/321ea/200549.png 786w" sizes="(max-width: 650px) 100vw, 650px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:172px">
      <a class="gatsby-resp-image-link" href="/static/6884ad1790905a35b0e4d7afb5a7c21f/44eb2/200609.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:87.73006134969326%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACR0lEQVQ4y62TW28SQRTH93P66ieoTTVRa9KPUBtto8T4oEYfraldAgi1IhWEQtOWi7AsC3vp3lnue+Hv7C7wQK02tpP8MjNnz/xy5kyWWntO46bc2/yE1a09PNiOglp5+hkrW/8JObv6LIo7a5u4u/Ea97djoJ5EErgJ65E4Hu3QePwiGuwpszeCbg1vBnGY/TFqnAIKtzhko3894fSq+HQa4HlhhqhaoOzJGIIgQlVUggxFVSGKIkajEWzbRs/qwSGzJIkwDBP2ZILxeAzbsQPZXBwINSLsGgbidBTJWAzfD9NIJBKg6RhKhRLiySRy2RwMTUPq4ABch8PZz2Mkv6SQOPyGycS5LPQXrusG13IcZ/ZxGqw9zw2++cPzPP9kULWf4zjunyu8Vg+n07/2cCFUrdt9ZUnrgfIb7jd5Qpq9jGv/G8cOH8n3tCWdPIppQicPYyyh6wa4Cx0tKYT1EbXFfh7ryHqQbxJPjRWIsGsuAuZMPuiZyDUUvMu0EC1y2Cu0QJd4xM8k0MU29o/9GAeazG8yHOqCTs50rxYOiTBdlVEoN6HyTWiyiExyHxvrD/Hq5Q4q5TJkgYPGs0idsDjlNIz6M6G5dGWNXHVgmfhaucButoF8mUGuwiGWziPyfhdvP8aQKlSRPWeRP2fwIcMQoRoUUW0S4bBvkb+hi34vxF/7MV4hVdYU/GioOKoryDUNFDt95FvmIhaiQjO6GA0sMG0JVLXJo8Jc5heJNzkBTCuk0eJRZztosPwiNqdK8n3P0UkDvwFJyBOKHMudxAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="200609" title="200609" src="/static/6884ad1790905a35b0e4d7afb5a7c21f/44eb2/200609.png" srcSet="/static/6884ad1790905a35b0e4d7afb5a7c21f/222b7/200609.png 163w,/static/6884ad1790905a35b0e4d7afb5a7c21f/44eb2/200609.png 172w" sizes="(max-width: 172px) 100vw, 172px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><blockquote><p><strong>译者注</strong>: 原文这里似乎确实又缺了一些图, 这两张图是我自己补上的</p></blockquote><h2 id="安装和注册-shell-扩展">安装和注册 Shell 扩展</h2><p>有多种安装和注册 SharpShell Shell 扩展的方法. 在本节中, 我将详细地介绍它们.</p><h3 id="the-regasm-tool">The regasm Tool</h3><p>您可以使用工具 &#x27;regasm&#x27; 来安装和注册 Shell 扩展. 使用 regasm 时, Shell 扩展将被安装至注册表中(COM Server 的 Class ID 将被放进 COM Server Class 部分中, 并与实际文件路径相关联), 这同样会注册文件类型关联.</p><h3 id="the-server-manager-tool">The Server Manager Tool</h3><p>Server Manager Tool 是我用来安装/卸载和注册/注销的首选方法, 至少在开发过程中如此. 因为它可以使你一键安装和注册. 它还可以让您指定是以 32 位还是以 64 位模式安装/卸载等.</p><h3 id="手动注册表操作">手动注册表操作</h3><p>通常, 这是一种不好的方法, 但是如果必须这样做的话, 则 Shell Extensions 的 MSDN 文档描述了一些必须对注册表进行的更改, 才能手动注册COM服务器或托管COM服务器. 该文档在 &quot;有用的资源&quot; 部分中列出. </p><h2 id="有用的资源">有用的资源</h2><ul><li><p><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc144171.aspx">Creating Shortcut Menu Handlers in Windows</a>: 最重要的资源 - 有关 Shell 上下文菜单扩展如何在 Windows 中工作的详细信息.</p></li><li><p><a href="http://sharpshell.codeplex.com/">CodePlex上的SharpShell</a>: <code class="language-text">SharpShell</code> 项目的所在地-包括文档，讨论以及最新的源代码和发行版. (译者注: 已迁移至 <a href="https://github.com/dwmkerr/sharpshell">Github</a>)</p></li></ul><h2 id="whats-next">What&#x27;s Next?</h2><p>随着时间的推移, <code class="language-text">SharpShell</code> 将提供一种使用 .Net 创建所有可用 Shell 扩展的机制. 目前已经实现了图标处理程序 (我正在处理文档), 并且实现了属性表处理程序 (Property Sheet Handlers)(仍需要解决一些错误). 每个扩展类型都会有一篇文章.</p><p>希望本文对您有所帮助. 对于功能请求, 错误或注释, 您可以使用下面的注释部分或CodePlex网站.</p><h2 id="历史">历史</h2><ul><li>2014年11月27日: 初始版本</li></ul><h2 id="license">License</h2><p>本文以及所有相关的源代码和文件均已获得 <a href="http://www.codeproject.com/info/cpol10.aspx">The Code Project Open License（CPOL）</a> 的许可.</p><h2 id="译注">译注</h2><ol><li><p>文章来源: <a href="https://www.codeproject.com/Articles/512956/NET-Shell-Extensions-Shell-Context-Menus">.NET Shell Extensions - Shell Context Menus - CodeProject</a> </p></li><li><p>原文作者: Dave Kerr, A softer Developer from UK. His blog: <a href="http://www.dwmkerr.com/">www.dwmkerr.com</a>, Github: <a href="https://github.com/dwmkerr">dwmkerr@Github</a></p></li><li><p>本文最早发表于 <strong>2014年11月27日</strong>, 截至翻译时最新更新为 <strong>2019年6月29日</strong>, 翻译日期为 <strong>2020年3月6日</strong>. <strong>互联网日新月异, 请注意信息时效</strong>.</p></li><li><p>文中的代码均测试通过, 文中除了标有 &quot;译者注&quot; 的部分之外均为原文, 译者水平有限, 如有疑惑之处请戳原文或 PM 我, 谢谢茄子. </p></li><li><p>纠结了好久, 最终还是决定代码中的英文注释不翻译. 这部分与代码相关较大, 希望能尽量保持原汁原味.</p></li></ol><table><thead><tr><th align="center">Version</th><th align="center">Action</th><th align="center">Time</th></tr></thead><tbody><tr><td align="center">1.0</td><td align="center">Init</td><td align="center">2020-03-07 15:20</td></tr><tr><td align="center">1.0</td><td align="center">迁移至 blog</td><td align="center">2020-04-28 19:49</td></tr></tbody></table><section class="post-entry-license"><p>作者: <!-- -->acdzh &amp; dave kerr<!-- --> <br/>本文出处:  <a target="_blank" rel="noreferrer" href=""></a><br/>互联网日新月异, 请注意文章时效. <br/><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i><i class="fab fa-creative-commons-nc"></i><i class="fab fa-creative-commons-sa"></i></a> 本作品采用 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a> 进行许可. 文章版权归作者所有, 允许转载, 但未经作者同意必须保留此段声明, 且在文章页面明显位置给出原文链接, 否则保留追究法律责任的权利.<br/></p></section><div class="post-tags"><a rel="nofollow" title="All categories" href="/categories/"><i class="fas fa-folder-open"></i></a> <a title="All posts in category 技术" rel="category tag" href="/categories/技术/">技术</a><a title="All posts in category CSharp" rel="category tag" href="/categories/CSharp/">CSharp</a><a title="All posts in category Windows" rel="category tag" href="/categories/Windows/">Windows</a>   <a rel="nofollow" title="All series" href="/series/"><i class="fas fa-bookmark"></i></a> <a title="All posts in series 从零开始的 .Net Shell 扩展教程" rel="series tag" href="/series/从零开始的 .Net Shell 扩展教程/">从零开始的 .Net Shell 扩展教程</a>   <a rel="nofollow" title="All tags" href="/tags/"><i class="fas fa-tags"></i></a> <a rel="tag" title="All post with tag SharpShell" href="/tags/SharpShell">SharpShell</a><a rel="tag" title="All post with tag CSharp" href="/tags/CSharp">CSharp</a><a rel="tag" title="All post with tag Windows" href="/tags/Windows">Windows</a><a rel="tag" title="All post with tag Windows Shell" href="/tags/Windows-Shell">Windows Shell</a></div></div></article></div></div></div></div><div class="content-main-sidebar"><div class="post-sidebar" style="position:sticky;top:60px"><div class="card-container" style="background-color:var(--BgSideBar)"><div class="card-container-top card-container-top__primary"><div class="card-container-top-inner">Catalog</div><div class="card-container-top-fold-button" role="button" tabindex="-1"><i class="fa fa-chevron-up" aria-hidden="true"></i></div></div><div class="card-content"><div class="sidebar-content-post-toc"><ul><li><a href="#介绍">介绍</a></li><li><a href="#系列文章">系列文章</a></li><li><a href="#什么是-shell-上下文菜单">什么是 Shell 上下文菜单?</a></li><li><a href="#入门">入门</a></li><li><a href="#我们的目标">我们的目标</a></li><li><a href="#第一步-建立项目">第一步: 建立项目</a></li><li><p><a href="#第二步-引用-sharpshell">第二步: 引用 SharpShell</a></p><ul><li><a href="#添加引用">添加引用</a></li><li><a href="#使用-nuget">使用 Nuget</a></li><li><a href="#使用-codeplex">使用 CodePlex</a></li></ul></li><li><p><a href="#第三步-从-sharpcontextmenu-继承-deriving-from-sharpcontextmenu">第三步: 从 SharpContextMenu 继承 (Deriving from SharpContextMenu)</a></p><ul><li><a href="#canshowmenu">CanShowMenu</a></li><li><a href="#createmenu">CreateMenu</a></li></ul></li><li><a href="#第四步-处理-com-注册">第四步: 处理 COM 注册</a></li><li><a href="#调试-shell-扩展">调试 Shell 扩展</a></li><li><p><a href="#安装和注册-shell-扩展">安装和注册 Shell 扩展</a></p><ul><li><a href="#the-regasm-tool">The regasm Tool</a></li><li><a href="#the-server-manager-tool">The Server Manager Tool</a></li><li><a href="#手动注册表操作">手动注册表操作</a></li></ul></li><li><a href="#有用的资源">有用的资源</a></li><li><a href="#whats-next">What&#x27;s Next?</a></li><li><a href="#历史">历史</a></li><li><a href="#license">License</a></li><li><a href="#译注">译注</a></li></ul></div><div class="sidebar-content-separator"></div><div class="sidebar-content-post-nav"><a rel="next" href="/tec/2020-03/sharpshell_tutorial_2/"><div class="sidebar-content-post-nav-item sidebar-content-post-nav-next"><i class="fas fa-chevron-right"></i><div><strong>Next post</strong><span>从零开始的 .Net Shell 扩展教程 (二) - Shell 图标处理程序 (Icon Handlers)</span></div></div></a><div class="sidebar-content-separator"></div><a rel="prev" href="/tec/2020-03/修复链断裂的虚拟磁盘/"><div class="sidebar-content-post-nav-item sidebar-content-post-nav-prev"><i class="fas fa-chevron-left"></i><div><strong>Previous Post</strong><span>修复链断裂的虚拟磁盘</span></div></div></a><div class="sidebar-content-separator"></div></div></div></div></div></div></main></div><footer class="footer"><a class="footer-back-topp" href="/tec/2020-03/sharpshell_tutorial_1/#"><i class="fas fa-angle-up"></i></a><section class="footer-container"><div class="footer-left-pad"><p>Copyright (c) <!-- -->2021<!-- -->. All rights reserved.</p><p style="margin-top:8px">Power by <a href="https://www.gatsbyjs.com/" target="_blank" rel="noreferrer">Gatsby</a>. Theme <a rel="noreferrer" href="https://github.com/acdzh/gatsby-theme-rapid" target="_blank">rapid</a>.</p></div><div class="footer-right-pad"><div class="footer-sociall-links"><a href="//github.com/acdzh/" target="_blank" rel="noreferrer" title="fork me on github"><i class="fab fa-github" aria-disabled="true"></i></a><a href="//steamcommunity.com/id/acdzh/" target="_blank" rel="noreferrer" title="play games with me"><i class="fab fa-steam" aria-disabled="true"></i></a><a href="//twitter.com/acdzh" target="_blank" rel="noreferrer" title="Twitter"><i class="fab fa-twitter" aria-disabled="true"></i></a><a href="mailto:acdzh@outlook.com" target="_blank" rel="noreferrer" title="Mail"><i class="far fa-envelope" aria-disabled="true"></i></a><a href="tencent://message/?uin=57082212&amp;Site=1069436872&amp;Menu=yes" target="_blank" rel="noreferrer" title="QQ"><i class="fab fa-qq" aria-disabled="true"></i></a><a href="//zhihu.com/people/kkkk-zzzz-13" target="_blank" rel="noreferrer" title="知乎"><i class="fab fa-zhihu" aria-disabled="true"></i></a><div style="font-size:1.1rem;margin-top:10px"><a href="//zhuanlan.zhihu.com/c_1159869906471759872" target="_blank" rel="noreferrer" title="知乎专栏">zhuanlan</a><a href="//cnblogs.com/acdzh" target="_blank" rel="noreferrer" title="博客园">cnblogs</a></div></div></div></section></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-148601605-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tec/2020-03/sharpshell_tutorial_1/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-64a2a5ba1fc84f7adec6.js"],"app":["/app-0acea366b700cb2006c4.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-52e91a4845622e8a8558.js"],"component---src-pages-categories-tsx":["/component---src-pages-categories-tsx-7f6479dfdac6f42bb715.js"],"component---src-pages-series-tsx":["/component---src-pages-series-tsx-6e4cccb681c376006967.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-e8e9aeb1442ea2c386b8.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx-5c1cf6bf4c7226315830.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-18a2e622c97be6b86328.js"],"component---src-templates-posts-tsx":["/component---src-templates-posts-tsx-f48d6173fb5a549f8fba.js"],"component---src-templates-series-tsx":["/component---src-templates-series-tsx-646c8ad9a811a169aca6.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-453226d33d7e12cbaf3d.js"]};/*]]>*/</script><script src="/polyfill-64a2a5ba1fc84f7adec6.js" nomodule=""></script><script src="/component---src-templates-post-tsx-18a2e622c97be6b86328.js" async=""></script><script src="/commons-952fdd3eb3e92eb702de.js" async=""></script><script src="/8c3ff73a-c498f4d9bc8664bd7de9.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-0acea366b700cb2006c4.js" async=""></script><script src="/framework-eb684e3e828ad13b3940.js" async=""></script><script src="/webpack-runtime-eadd60745f2c20ad7d5b.js" async=""></script></body></html>